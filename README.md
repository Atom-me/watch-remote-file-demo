# 代码没写完，方案被放弃20230731

> 很多细节没实现
>
> 1. 存量数据未处理
> 2. 删除文件未处理
> 3. 移动文件未处理
> 4. 文件内容更新未处理
> 5. 仅实现了文件更新中的文本文件的内容追加
> 6. 集群部署未支持
> 7. 启动多个服务在远端Linux服务器会启动多个inotifywait进程，未处理
> 8. 。。。。

# 需求：

> 1. 监控远端Linux服务器指定目录
> 2. 获取目录内新增的文件和更新的文件
> 3. 把新增的文件内容和更新的文件内容上传到远端FTP服务器指定目录

### inotify-tools安装（CentOS）

```shell
#需要epel源
yum install -y inotify-tools
```

#### inotify-tools包相关命令

inotify-tools工具有两个命令，分别是：

- **inotifywait** - 用于持续监控，实时输出结果。
- **inotifywatch** - 用于短期监控，任务完成后输出结果。

##### inotifywait 主要有以下选项：

```
-m  表示持续监控
-r  递归监控
-q  简化输出信息
-e  指定监控数据的事件类型，多个事件类型用英文状态的逗号隔开
```

事件类型如下：

| 事件类型      | 说明                                                 |
| :------------ | :--------------------------------------------------- |
| access        | 文件或目录的内容进行访问                             |
| modify        | 文件或目录的内容被写入                               |
| attrib        | 文件或目录的属性被修改                               |
| close_write   | 文件或目录在可写模式下打开后关闭                     |
| close_nowrite | 文件或目录在以只读模式打开后关闭                     |
| close         | 无论读/写模式，文件或目录关闭                        |
| open          | 文件或者目录被打开                                   |
| moved_to      | 有文件或目录移动到监控的目录中                       |
| moved_from    | 有文件或目录从监控的目录中移出                       |
| move          | 有文件或者目录，被移动到监控目录或者从监控目录中移出 |
| move_self     | 已移动受监视的文件或目录                             |
| create        | 被监控的目录内有创建的文件或目录                     |
| delete        | 被监控的目录内有文件或目录被删除                     |
| delete_self   | 文件或目录已经被删除                                 |
| unmount       | 包含已卸载文件或目录的文件系统                       |